<!DOCTYPE html>
<html style="height: 100%">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Domain Nexus</title>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="../plugins/font-awesome/css/font-awesome.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="../dist/css/adminlte.min.css">
    <!-- Google Font: Source Sans Pro -->
    <link href="../dist/css/fonts.css" rel="stylesheet">
    <link href="../dist/css/domain.css" rel="stylesheet">

    <!-- Ion Slider -->
    <link rel="stylesheet" href="../plugins/ion.rangeslider/css/ion.rangeSlider.css">
    <link rel="stylesheet" href="../plugins/ion.rangeslider/css/ion.rangeSlider.skinSimple.css">
    <!-- Select2 -->
    <link rel="stylesheet" href="../plugins/select2/select2.min.css">
    <!-- DatePicker -->
    <link rel="stylesheet" href="../plugins/datepicker/css/bootstrap-datepicker.css">
</head>

<body class="hold-transition sidebar-mini sidebar-collapse">
    <div class="wrapper">
        <nav id="navbar" class="main-header navbar navbar-expand bg-white navbar-light border-bottom"></nav>
        <aside id="sidebar" class="main-sidebar sidebar-dark-primary elevation-4"></aside>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <!-- Content Header (Page header) -->
            <div id="contentheader" class="content-header"></div>
            <!-- /.content-header -->

            <!-- Main content -->
            <div id="container"></div>
            <!-- /.content -->
        </div>
        <!-- /.content-wrapper -->

        <!-- Control Sidebar -->
        <aside id="controlsidebar" class="control-sidebar control-sidebar-dark" style="top:57px">
        </aside>
        <div id="control-dashboard" class="control-sidebar-custom">
        </div>
        <div id="control-api-panel" class="control-sidebar-custom">
        </div>
        <!-- Main Footer -->
        <footer id="footer" class="main-footer"></footer>
    </div>
    <!-- ./wrapper -->

    <!-- REQUIRED SCRIPTS -->
    <!-- jQuery -->
    <script src="../plugins/jquery/jquery.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="../plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- AdminLTE App -->
    <script src="../dist/js/adminlte.min.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script src="../dist/js/gtag.js"></script>

    <!-- OPTIONAL SCRIPTS -->
    <!-- Ion Slider -->
    <script src="../plugins/ion.rangeslider/js/ion.rangeSlider.min.js"></script>
    <!-- Select2 -->
    <script src="../plugins/select2/select2.full.min.js"></script>
    <!-- DatePicker -->
    <script src="../plugins/datepicker/js/bootstrap-datepicker.min.js"></script>

    <script src="../plugins/echarts/echarts.min.js"></script>
    <script src="../plugins/echarts/map/world.js"></script>

    <script src="../dist/js/pages/graph-lib.js"></script>

    <script type="text/javascript">
        $(function () {
            $("#navbar").load("../shared/navbar.html");
            $("#footer").load("../shared/footer.html");

            $("#container").css("height", document.body.clientHeight -
                    $(".main-header").outerHeight() - $(".content-header").outerHeight() - 100)
                .click(function () {
                    $('body').removeClass('control-sidebar-slide-open');
                });

            if (querystring('domain') != undefined) {
                var keyword = querystring('domain').replace("+", "-");
                $("#sidebar").load("../shared/sidebar.html", function () {
                    $(".sidebar li.domain-" + keyword + ">a").addClass("active");
                });

                var dom = document.getElementById("container");
                var chart = echarts.init(dom);
                chart.showLoading();

                $("#contentheader").load("../shared/contentheader.html");
                $("#controlsidebar").load("../shared/controlsidebar.html", function () {
                    init_chart(keyword, chart);
                });

                // control-dashboard script
                $("#control-dashboard").load("../shared/control-dashboard.html", function () {
                    $(this).css("height", window.innerHeight - $(".main-header").outerHeight());

                    // hardcode for network problems and take action
                    $("#panel-optimate .card-footer .card-comment:first").click(function () {
                        $(this).remove();
                        $("#panel-optimate .card-body").show();

                        //http://127.0.0.1/nexus/pages/domain-viewer.html?domain=blockchain
                        //&type=f&group=functionalarea&date=&node=58&edge=82&label=0
                        //&nocates=Communications,Development,Finance,General%20Management%20%26%20Admin,Human%20Resources,None,Services,Education%20and%20Knowledge%20Services,Information%20Technology&cache=true
                        config.DOMAIN = 'blockchain';
                        config.CHART_TYPE = 'force';
                        config.GROUP_BY_FIELD = 'functionalarea';
                        config.THRESHOLD_NODE = 100 - 58;
                        config.THRESHOLD_EDGE = 100 - 82;
                        config.MODE_SHOW_LABEL = 2;
                        config.THRESHOLD_SHOW_LABEL = 70;
                        config.HIDDEN_LEGEND['Communications'] = false;
                        config.HIDDEN_LEGEND['Development'] = false;
                        config.HIDDEN_LEGEND['Finance'] = false;
                        config.HIDDEN_LEGEND['General Management & Admin'] = false;
                        config.HIDDEN_LEGEND['Human Resources'] = false;
                        config.HIDDEN_LEGEND['None'] = false;
                        config.HIDDEN_LEGEND['Services'] = false;
                        config.HIDDEN_LEGEND['Education and Knowledge Services'] = false;
                        config.HIDDEN_LEGEND['Information Technology'] = false;
                        config.CACHE = true;

                        chart.showLoading();

                        var ds = generate_dataset(config.DATA_SOURCE);
                        var option = get_option(ds);
                        bind_select2(ds, $("#ddl-search"), config.DOMAIN);

                        chart.hideLoading();

                        if (option && typeof option === "object") {
                            chart.setOption(option, true);
                        }
                    });

                    $("#panel-optimate .card-body #btn-action").click(function () {
                        console.log(
                            "add link between Emily Loggenberg (I321755) and Mandy Lin (I833471) and I828442"
                        );

                        chart.showLoading();

                        var ds = generate_dataset(config.DATA_SOURCE);
                        ds.links.push({
                            "source": "I321755",
                            "target": "I833471",
                            "weight": 1000,
                            "lineStyle": {
                                "normal": {
                                    "curveness": 0.2,
                                    "width": 5,
                                    "opacity": 0.5,
                                    "color": "#28a745"
                                }
                            }
                        });
                        var option = get_option(ds);
                        option.series[0].focusNodeAdjacency = true;
                        option.series[0].tooltip = {
                            formatter: function (param) {
                                if (param.dataType == 'edge') {
                                    if (param.data.weight == 1000) {
                                        return '<p>A closer collaboration between <br /> <span class="badge bg-primary">Mandy Lin (74.03)</span> and <span class="badge bg-primary">Emily Loggenberg (91.24)</span> <br />will increase the collaboration structure by 20%</p>'
                                    }
                                } else if (param.dataType == 'node') {
                                    return get_tooltips(param).join('');
                                }
                            }
                        }

                        bind_select2(ds, $("#ddl-search"), config.DOMAIN);

                        chart.hideLoading();

                        if (option && typeof option === "object") {
                            chart.setOption(option, true);
                        }
                    });
                });


                // control-api-panel script
                $("#control-api-panel").load("../shared/control-api-panel.html", function () {
                    $(this).css("height", window.innerHeight - $(".main-header").outerHeight());

                    $(".pnl-api-describe").click(function () {
                        $(this).siblings(".pnl-api-debug").toggle(500);
                    });

                    $("#btn-api-communities").click(function () {
                        //  http://10.178.200.23/Nexus/pages/domain-viewer.html?domain=blockchain&type=f&group=community&date=&node=100&edge=80&label=0&nocates=000066,000046,000020,000014,000059,000072,000147,000036,000050,000010,000128,000028,000187,000207,000064,000034,000000,000145,000255,000029,000061,000011,000263,000103,000053,000075,000124,000143,000016,000071,000212,000189,000242,000044,000154,000164,000038,000089,000047,000022,000045,000188,000137,000015,000127,000041,000173,000232,000112,000208,000084,000025,000146,000151,000169,000219,000247,000031,000195,000249,000098,000194,000006,000198,000018,000120,000150,000133,000106,000008,000177,000091,000213,000191,000087,000121,000217,000017,000057,000019,000027,000001,000258,000206,000160,000069,000185,000156,000074,000032,000238,000115,000051,000253,000210,000095,000021,000054,000205,000003,000267,000042,000155,000063,000265,000117,000193,000088,000199,000167,000237,000203,000181,000082,000241,000068,000170,000048,000109,000013,000246,000184,000076,000108,000218,000257,000158,000090,000119,000111,000080,000039,000043,000126,000009,000026,000132,000153,000007,000142,000097,000101,000196,000165,000122,000157,000261,000005,000070,000171,000104,000135,000130,000055,000190,000129,000002,000224,000062,000244,000123,000085,000118,000180,000225,000243,000141,000168,000215,000102,000086,000073,000248,000152,000202,000216,000037,000114,000235,000159,000200,000256,000067,000035,000140,000222,000092,000148,000214,000096,000049,000172,000183,000204,000227,000083,000033,000116,000251,000110,000236,000100,000260,000245,000058,000182,000240,000012,000134,000094,000081,000099,000250,000056,000197,000004,000024,000065,000138,000163,000264,000233,000030,000078,000220,000079,000192,000231,000175,000139,000144,000229,000186,000131,000211,000209,000105,000162,000174,000040,000179,000226,000176,000149,000125,000136,000221,000161,000230,000228,000077,000266,000223,000254,000178,000234,000262,000201,000060,000113,000259,000093,000107,000166,000252,000239,None
                        config.DOMAIN = 'blockchain';
                        config.CHART_TYPE = 'force';
                        config.GROUP_BY_FIELD = 'community';
                        config.THRESHOLD_NODE = 100 - 100;
                        config.THRESHOLD_EDGE = 100 - 80;
                        config.MODE_SHOW_LABEL = 0;
                        config.THRESHOLD_SHOW_LABEL = 70;

                        var str_nocates =
                            "000066,000046,000020,000014,000059,000072,000147,000036,000050,000010,000128,000028,000187,000207,000064,000034,000000,000145,000255,000029,000061,000011,000263,000103,000053,000075,000124,000143,000016,000071,000212,000189,000242,000044,000154,000164,000038,000089,000047,000022,000045,000188,000137,000015,000127,000041,000173,000232,000112,000208,000084,000025,000146,000151,000169,000219,000247,000031,000195,000249,000098,000194,000006,000198,000018,000120,000150,000133,000106,000008,000177,000091,000213,000191,000087,000121,000217,000017,000057,000019,000027,000001,000258,000206,000160,000069,000185,000156,000074,000032,000238,000115,000051,000253,000210,000095,000021,000054,000205,000003,000267,000042,000155,000063,000265,000117,000193,000088,000199,000167,000237,000203,000181,000082,000241,000068,000170,000048,000109,000013,000246,000184,000076,000108,000218,000257,000158,000090,000119,000111,000080,000039,000043,000126,000009,000026,000132,000153,000007,000142,000097,000101,000196,000165,000122,000157,000261,000005,000070,000171,000104,000135,000130,000055,000190,000129,000002,000224,000062,000244,000123,000085,000118,000180,000225,000243,000141,000168,000215,000102,000086,000073,000248,000152,000202,000216,000037,000114,000235,000159,000200,000256,000067,000035,000140,000222,000092,000148,000214,000096,000049,000172,000183,000204,000227,000083,000033,000116,000251,000110,000236,000100,000260,000245,000058,000182,000240,000012,000134,000094,000081,000099,000250,000056,000197,000004,000024,000065,000138,000163,000264,000233,000030,000078,000220,000079,000192,000231,000175,000139,000144,000229,000186,000131,000211,000209,000105,000162,000174,000040,000179,000226,000176,000149,000125,000136,000221,000161,000230,000228,000077,000266,000223,000254,000178,000234,000262,000201,000060,000113,000259,000093,000107,000166,000252,000239,None";

                        var arr = str_nocates.split(',');
                        if (arr.length > 0) {
                            for (var i in arr) {
                                var cate = decodeURIComponent(arr[i]);
                                config.HIDDEN_LEGEND[cate] = false;
                            }
                        }

                        config.CACHE = false;

                        chart.showLoading();

                        var ds = generate_dataset(config.DATA_SOURCE);
                        var option = get_option(ds);
                        bind_select2(ds, $("#ddl-search"), config.DOMAIN);

                        chart.hideLoading();

                        if (option && typeof option === "object") {
                            chart.setOption(option, true);
                            $("button#btn-search-reset").click();
                        }
                    });

                    $("#btn-api-broker").click(function () {
                        config.DOMAIN = 'blockchain';
                        config.CHART_TYPE = 'circular';
                        config.GROUP_BY_FIELD = 'networktype';
                        config.THRESHOLD_NODE = 100 - 100;
                        config.THRESHOLD_EDGE = 100 - 80;
                        config.MODE_SHOW_LABEL = 0;
                        config.THRESHOLD_SHOW_LABEL = 70;
                        config.HIDDEN_LEGEND = {};
                        config.CACHE = false;

                        chart.showLoading();

                        var ds = generate_dataset(config.DATA_SOURCE);
                        var option = get_option(ds);

                        bind_select2(ds, $("#ddl-search"), config.DOMAIN);

                        chart.hideLoading();

                        if (option && typeof option === "object") {
                            chart.setOption(option, true);

                            // highlight [Brokers] Raimund Gross (D032728)

                            // var selected = $('#ddl-search').find('option[text="[Brokers] Raimund Gross (D032728)"]').val();
                            // alert(selected);
                            $("#ddl-search").val(24);
                            $("#ddl-search").trigger("change");
                        }
                    });
                });
            }
        });
    </script>
</body>

</html>